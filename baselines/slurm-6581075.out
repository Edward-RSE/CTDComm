Running SLURM prolog script on gold54.cluster.local
===============================================================================
Job started on Mon Sep 23 16:09:49 BST 2024
Job ID          : 6581075
Job name        : train_dpp_5v1_dec_tarmac.sh
WorkDir         : /mainfs/home/jabn1n20/CTDComm/baselines
Command         : /mainfs/home/jabn1n20/CTDComm/baselines/dec_scripts/train_dpp_5v1_dec_tarmac.sh
Partition       : serial
Num hosts       : 1
Num cores       : 8
Num of tasks    : 8
Hosts allocated : gold54
Job Output Follows ...
===============================================================================
Namespace(action_scale=1.0, advantages_per_action=False, alpha=0.99, batch_size=500, cave=False, comm_action_one=False, comm_init='uniform', comm_mask_zero=False, comm_mode='avg', comm_passes=1, comm_range=0, commnet=1, continuous=False, dec_tarmac=True, detach_gap=10, dim=10, dim_actions=2, directed=False, display=False, entr=0.01, env_name='dec_predator_prey', env_seed=None, epoch_size=10, eps=1e-06, first_gat_normalize=False, first_graph_complete=False, gacomm=False, gamma=0.99, gat_encoder_normalize=False, gat_encoder_out_size=64, gat_hid_size=64, gat_num_heads=1, gat_num_heads_out=1, ge_num_heads=4, hard_attn=1, hid_size=128, ic3net=True, learn_second_graph=False, learning_prey=False, load='', lrate=0.0007, magic=False, max_steps=40, mean_ratio=0, message_decoder=False, message_encoder=False, mode='mixed', moving_prey=False, naction_heads=[5, 2], nactions='1', nagents=5, nenemies=1, nfriendly=5, normalize_rewards=False, nprocesses=16, num_actions=[5, 2], num_epochs=500, num_inputs=(104, 3, 3), plot=False, plot_env='main', plot_port='8097', qk_hid_size=16, random=False, recurrent=True, rnn_type='LSTM', save=True, save_adjacency=False, save_every=25, second_gat_normalize=False, second_graph_complete=False, seed=1, self_loop_type1=2, self_loop_type2=2, share_weights=False, stay=True, tarcomm=False, tau=1.0, use_gat_encoder=False, value_coeff=0.01, value_hid_size=32, vision=1)
Traceback (most recent call last):
  File "run_baselines.py", line 271, in <module>
    policy_net = DecTarMAC(args, num_inputs)
  File "/mainfs/home/jabn1n20/CTDComm/baselines/dec_tarmac.py", line 55, in __init__
    self.agents = nn.ModuleList([DecAgent(args, num_inputs, a_id) for a_id in range(args.nagents)])
  File "/mainfs/home/jabn1n20/CTDComm/baselines/dec_tarmac.py", line 55, in <listcomp>
    self.agents = nn.ModuleList([DecAgent(args, num_inputs, a_id) for a_id in range(args.nagents)])
  File "/mainfs/home/jabn1n20/CTDComm/baselines/dec_agent.py", line 48, in __init__
    self.encoder = nn.Linear(num_inputs, args.hid_size)
  File "/home/jabn1n20/.conda/envs/commpy/lib/python3.7/site-packages/torch/nn/modules/linear.py", line 72, in __init__
    self.weight = Parameter(torch.Tensor(out_features, in_features))
TypeError: new(): argument 'size' must be tuple of ints, but found element of type tuple at pos 2
==============================================================================
Running epilogue script on gold54.

Submit time  : 2024-09-23T16:09:08
Start time   : 2024-09-23T16:09:49
End time     : 2024-09-23T16:10:13
Elapsed time : 00:00:24 (Timelimit=2-12:00:00)

Job ID: 6581075
Cluster: i5
User/Group: jabn1n20/fp
State: FAILED (exit code 1)
Nodes: 1
Cores per node: 8
CPU Utilized: 00:00:03
CPU Efficiency: 1.56% of 00:03:12 core-walltime
Job Wall-clock time: 00:00:24
Memory Utilized: 2.41 MB
Memory Efficiency: 0.00% of 184.57 GB

